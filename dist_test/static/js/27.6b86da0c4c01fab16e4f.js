webpackJsonp([27],{701:function(t,e,a){a(994),a(993);var n=a(5)(a(815),a(940),"data-v-36c71476",null);n.options.__file="D:\\baozWork\\fontend\\ECMS\\src\\view\\customerManage\\customerList.vue",n.esModule&&Object.keys(n.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] customerList.vue: functional components are not supported with templates, they should use render functions."),t.exports=n.exports},815:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(332),i=a.n(n),r=a(0),s=a.n(r);e.default={name:"",data:function(){return{form:this.$form.createForm(this),queryParam:{key:"",label:[],department_id:"",startTime:"",endTime:""},departmentList:[],labelList:[],expand:!1,customerList:[],columns:[{title:"头像",dataIndex:"avatar_url",align:"center",scopedSlots:{customRender:"avatar_url"}},{title:"昵称",align:"center",dataIndex:"nickname"},{title:"所属机器人昵称",align:"center",dataIndex:"assistant_name"},{title:"姓名",align:"center",dataIndex:"real_name"},{title:"电话",align:"center",dataIndex:"tel"},{title:"生日",align:"center",dataIndex:"birth",customRender:function(t,e,a){return"0000-00-00"==t?"":t}},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],page_size:10,page:1,total:0}},mounted:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},updated:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},methods:{moment:s.a,toggle:function(){this.expand=!this.expand},clear:function(){this.queryParam={key:"",label:[],department_id:this.departmentList[0].id,startTime:"",endTime:""},this.getCustomer()},exportContact:function(){location.href="/index.php?r=uc/customer/export-friends&key="+this.queryParam.key+"&label="+this.queryParam.label+"&department_id="+this.queryParam.department_id+"&startTime="+this.queryParam.startTime+"&endTime="+this.queryParam.endTime},handleLabelChange:function(t){this.queryParam.label=t},handleChange:function(t){this.queryParam.department_id=t},onChangeDate:function(t,e){this.queryParam.startTime=e[0],this.queryParam.endTime=e[1]},onChange:function(t,e){this.page=t,this.page_size=e,this.getCustomer()},onShowSizeChange:function(t,e){this.page=1,this.page_size=e,this.getCustomer()},handleSubmit:function(){this.page=1,this.page_size=10,this.getCustomer()},getAllCustonerLabel:function(){var t=this;this.$axios({method:"POST",url:"/index.php?r=uc/material/customer-label",data:{department_id:this.$store.state.user.user.department.id,company:1}}).then(function(e){var a=e.data;1==a.status&&(t.labelList=a.data)})},getDepartment:function(){var t=this;this.$axios({method:"GET",url:"/index.php?r=uc/customer/get-department",params:{department_id:this.$store.state.user.user.department.id}}).then(function(e){var a=e.data;1==a.status&&(t.departmentList=a.data,t.queryParam.department_id=a.data[0].id,t.getCustomer())})},getCustomer:function(){var t=this;this.$axios({method:"GET",url:"/index.php?r=uc/customer/list",params:i()(this.queryParam,{p:this.page,n:this.page_size})}).then(function(e){var a=e.data;1==a.status&&(t.customerList=a.data.list,t.total=parseInt(a.data.count))})},getDetail:function(t){this.$router.push({path:"/home/customerDetails",query:{id:t}})},sendMsg:function(t){this.$router.push({path:"/customerChat/liveChat",query:{id:t}})},upInfo:function(t){var e={cmd:2036,fromClientId:this.$store.state.user.user.user_id,toClientId:t.robot_username,cmdData:{username:t.friend_user_name}};this.$ws.sendMsgFun(e),this.$message.success("已更新，需要刷新页面获取最新信息")}},created:function(){this.getAllCustonerLabel(),this.getDepartment()}}},859:function(t,e,a){e=t.exports=a(3)(!1),e.push([t.i,"\n.customer-list .ant-table-thead > tr > th,.customer-list .ant-table-tbody > tr > td {\n    padding: 10px;\n}\n",""])},860:function(t,e,a){e=t.exports=a(3)(!1),e.push([t.i,"\n.customer-list[data-v-36c71476] {\n  background: #ffffff;\n  height: calc(100vh - 90px);\n  overflow-y: auto;\n}\n.customer-list .header[data-v-36c71476] {\n  padding: 20px;\n}\n.customer-list .content[data-v-36c71476] {\n  padding: 0 20px;\n}\n",""])},940:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customer-list"},[a("div",{staticClass:"header"},[a("a-form",{staticStyle:{padding:"10px",background:"#fff"},attrs:{layout:"inline",form:t.form},on:{submit:t.handleSubmit}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-item",[a("span",[t._v("搜索用户：")]),t._v(" "),a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入微信昵称、用户姓名"},model:{value:t.queryParam.key,callback:function(e){t.$set(t.queryParam,"key",e)},expression:"queryParam.key"}})],1)],1),t._v(" "),a("a-col",{attrs:{span:8}},[a("a-form-item",[a("span",[t._v("选择标签：")]),t._v(" "),a("a-select",{staticStyle:{width:"300px"},attrs:{mode:"multiple",placeholder:"请选择标签"},on:{change:t.handleLabelChange},model:{value:t.queryParam.label,callback:function(e){t.$set(t.queryParam,"label",e)},expression:"queryParam.label"}},t._l(t.labelList,function(e,n){return a("a-select-option",{key:e.id},[t._v("\n                                "+t._s(e.title)+"\n                            ")])}),1)],1)],1),t._v(" "),a("a-col",{staticStyle:{height:"39px","line-height":"39px","text-align":"right"},attrs:{span:8}},[a("a-button",{attrs:{type:"primary",htmlType:"submit"}},[t._v("查询")]),t._v(" "),a("a-button",{on:{click:t.clear}},[t._v("重置")]),t._v(" "),a("a",{style:{marginLeft:"8px",fontSize:"12px"},on:{click:t.toggle}},[a("span",[t._v(t._s(t.expand?"收起":"展开"))]),t._v(" "),a("a-icon",{attrs:{type:t.expand?"up":"down"}})],1)],1)],1),t._v(" "),a("a-row",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"expand"}],staticStyle:{"padding-top":"5px"}},[a("a-col",{attrs:{span:8}},[a("a-form-item",[a("span",[t._v("选择部门：")]),t._v(" "),a("a-select",{staticStyle:{width:"300px"},on:{change:t.handleChange},model:{value:t.queryParam.department_id,callback:function(e){t.$set(t.queryParam,"department_id",e)},expression:"queryParam.department_id"}},t._l(t.departmentList,function(e,n){return a("a-select-option",{key:e.id},[t._v("\n                                "+t._s(e.name)+"\n                            ")])}),1)],1)],1),t._v(" "),a("a-col",{attrs:{span:8}},[a("a-form-item",[a("span",[t._v("添加时间：")]),t._v(" "),a("a-range-picker",{staticStyle:{width:"300px"},on:{change:t.onChangeDate}})],1)],1),t._v(" "),a("a-col",{staticStyle:{height:"39px","line-height":"39px","text-align":"right"},attrs:{span:8}},[a("a-button",{attrs:{type:"primary"},on:{click:t.exportContact}},[t._v("导出联系人")])],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"content"},[a("a-table",{attrs:{columns:t.columns,dataSource:t.customerList,pagination:!1},scopedSlots:t._u([{key:"avatar_url",fn:function(t,e,n){return[a("div",[a("a-avatar",{staticStyle:{"border-radius":"5px"},attrs:{src:t,size:48}})],1)]}},{key:"action",fn:function(e,n,i){return[a("div",[a("a",{staticStyle:{"padding-right":"15px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.sendMsg(n.id)}}},[t._v("发消息")]),t._v(" "),a("a",{staticStyle:{"padding-right":"15px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.getDetail(n.id)}}},[t._v("详细信息")]),t._v(" "),a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.upInfo(n)}}},[t._v("更新信息")])])]}}])}),t._v(" "),a("br"),t._v(" "),a("a-pagination",{staticStyle:{"text-align":"right"},attrs:{showQuickJumper:"",showSizeChanger:"",showTotal:function(t){return"总共"+t+"条"},pageSize:t.page_size,total:t.total,pageSizeOptions:["10","20","30","40","50"]},on:{change:t.onChange,showSizeChange:t.onShowSizeChange},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}),t._v(" "),a("br")],1)])},staticRenderFns:[]},t.exports.render._withStripped=!0},993:function(t,e,a){var n=a(859);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(4)("d11f80d4",n,!1)},994:function(t,e,a){var n=a(860);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(4)("347e9904",n,!1)}});