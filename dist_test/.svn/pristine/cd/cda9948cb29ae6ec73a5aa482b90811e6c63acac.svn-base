webpackJsonp([33],{700:function(t,a,e){e(983);var n=e(5)(e(814),e(933),"data-v-0f349b9a",null);n.options.__file="D:\\baozWork\\fontend\\ECMS\\src\\view\\customerManage\\customerDetails.vue",n.esModule&&Object.keys(n.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] customerDetails.vue: functional components are not supported with templates, they should use render functions."),t.exports=n.exports},814:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e(332),o=e.n(n),s=e(0),i=e.n(s);a.default={name:"newMsg",data:function(){return{id:this.$route.query.id,contactInfo:{},contactLabel:[],allLabel:[],departmentInfo:{},adviser_all:[],editStatus:!1,selectTagFlag:!1,confirmLoading:!1,page:1,page_size:10,total:0,orderList:[],columns:[{title:"单号",align:"center",dataIndex:"order_id"},{title:"名称",align:"center",dataIndex:"title"},{title:"类别",align:"center",dataIndex:"order_type",customRender:function(t,a,e){return 10==t?"购买":"赠送"}},{title:"货号",align:"center",dataIndex:"item_number"},{title:"价格(元)",align:"center",dataIndex:"price"},{title:"数量",align:"center",dataIndex:"num"},{title:"时间",align:"center",dataIndex:"created"},{title:"备注",align:"center",dataIndex:"desc"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],orderTitle:"新增订单",orderFlag:!1,orderDetail:{},goodsClass:[],goodsAll:[]}},methods:{moment:i.a,back:function(){this.$router.back(-1)},getOrderList:function(){var t=this;this.$axios({method:"GET",url:"/index.php?r=uc/customer/order-list",params:{id:this.id,p:this.page,n:this.page_size}}).then(function(a){var e=a.data;1==e.status&&(t.orderList=e.data.list,t.total=parseInt(e.data.count))})},getDeatials:function(){var t=this;this.$axios({method:"GET",url:"/index.php?r=uc/customer/friend-details",params:{id:this.id}}).then(function(a){var e=a.data;if(1==e.status)if(t.contactInfo=e.data.info,t.contactLabel=e.data.label_own,t.allLabel=e.data.label_all,t.departmentInfo=e.data.department_own,t.adviser_all=e.data.adviser_all,""==e.data.adviser_own?(t.contactInfo.adviser_id="",t.contactInfo.adviser_name=""):(t.contactInfo.adviser_id=e.data.adviser_own.id,t.contactInfo.adviser_name=e.data.adviser_own.user_name),t.contactLabel.forEach(function(t){t.showFlag=!0}),"0000-00-00"==t.contactInfo.birth){var n=new Date;t.contactInfo.birth=n.getFullYear()+"-"+(parseInt(n.getMonth())+1)+"-"+n.getDate(),t.contactInfo.birthTime=""}else t.contactInfo.birthTime=t.contactInfo.birth})},onChangeBirth:function(t,a){this.contactInfo.birth=a},edit_save:function(){var t=this;this.editStatus?this.$axios({method:"POST",url:"/index.php?r=uc/customer/friend-edit",data:o()(this.contactInfo)}).then(function(a){1==a.data.status&&(t.$message.success("修改成功"),t.editStatus=!t.editStatus,t.getDeatials())}):this.editStatus=!this.editStatus},closeTag:function(t,a,e){var n=this;t.preventDefault();var o={cmd:2040,fromClientId:this.$store.state.user.user.user_id,toClientId:this.contactInfo.assistant_username,cmdData:{username:this.contactInfo.username,labels:[a.label_name]}};this.$ws.sendMsgFun(o),this.$ws.cmd2040=function(){a.showFlag=!1,n.$set(n.contactLabel,e,a),n.$message.success("删除成功")}},addTag:function(){var t=this;this.allLabel.forEach(function(a){t.contactLabel.forEach(function(t){a.id==t.label_id&&(a.check=!0)})}),this.selectTagFlag=!0},handleTagChange:function(t,a,e){t.check=e,this.$set(this.allLabel,a,t)},handleTagOk:function(){var t=this,a=[];this.allLabel.forEach(function(t){t.check&&a.push(t.id+"_"+t.title)});var e={cmd:2040,fromClientId:this.$store.state.user.user.user_id,toClientId:this.contactInfo.assistant_username,cmdData:{username:this.contactInfo.username,labels:a},priority:0};this.$ws.sendMsgFun(e),this.selectTagFlag=!1,this.$message.success("设置标签成功"),this.$ws.cmd2040=function(a){t.getDeatials()}},onChange:function(t,a){this.page=t,this.page_size=a,this.getCustomer()},onShowSizeChange:function(t,a){this.page=1,this.page_size=a,this.getCustomer()},addOrder:function(t){this.orderTitle="新增订单",this.orderFlag=!0,this.orderDetail={id:"",order_time:"",desc:""},this.getGoodsClass()},editOrder:function(t){this.orderTitle="编辑订单",this.orderFlag=!0,this.orderDetail=t,this.getGoodsClass(),this.getGoodsAll(t.goods_class_id)},getGoodsClass:function(){var t=this;this.$axios({method:"GET",url:"/index.php?r=uc/customer/goods-class"}).then(function(a){var e=a.data;1==e.status&&(t.goodsClass=e.data)})},handleClassChange:function(t){this.getGoodsAll(t)},getGoodsAll:function(t){var a=this;this.$axios({method:"GET",url:"/index.php?r=uc/customer/class-goods-all",params:{classId:t}}).then(function(t){var e=t.data;if(1==e.status){a.goodsAll=e.data;var n=!1;if(0==a.goodsAll.length)return a.orderDetail.goods_id="",void a.$message.warning("当前类别暂无商品，请先添加商品");a.goodsAll.forEach(function(t){t.id==a.orderDetail.goods_id&&(n=!0)}),!n&&(a.orderDetail.goods_id=a.goodsAll[0].id)}})},handleOrderOk:function(){var t=this;this.$axios({method:"POST",url:"/index.php?r=uc/customer/order-add",data:o()(this.orderDetail,{friends_id:this.contactInfo.id})}).then(function(a){1==a.data.status&&(t.$message.success(t.orderTitle+"成功"),t.orderFlag=!1,t.getOrderList())})},handAdviserChange:function(t){this.contactInfo.adviser_id=t},del:function(t){var a=this;this.$axios({method:"POST",url:"/index.php?r=uc/customer/order-del",data:{id:t}}).then(function(t){1==t.data.status&&(a.$message.success("删除成功"),a.getOrderList())})}},beforeCreate:function(){},mounted:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},updated:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},created:function(){this.getDeatials(),this.getOrderList()}}},849:function(t,a,e){a=t.exports=e(3)(!1),a.push([t.i,'/*清除浮动代码*/\n.hide[data-v-0f349b9a] {\n  display: none;\n}\n.clearFloat[data-v-0f349b9a]:after {\n  display: block;\n  clear: both;\n  content: "";\n  visibility: hidden;\n  height: 0;\n}\n.clearFloat[data-v-0f349b9a] {\n  zoom: 1;\n}\n.fr[data-v-0f349b9a] {\n  float: right;\n}\n.fl[data-v-0f349b9a] {\n  float: left;\n}\n.customer-details[data-v-0f349b9a] {\n  color: #101010;\n  position: relative;\n  height: calc(100vh - 90px);\n  overflow: auto;\n}\n.customer-details .customer-info-wx[data-v-0f349b9a] {\n  padding: 10px 25px;\n  background: #ffffff;\n}\n.customer-details .customer-info-wx span[data-v-0f349b9a] {\n  margin-left: 20px;\n}\n.customer-details .customer-info[data-v-0f349b9a],\n.customer-details .label-info[data-v-0f349b9a],\n.customer-details .order-info[data-v-0f349b9a] {\n  background: #ffffff;\n}\n.customer-details .customer-info .info-header[data-v-0f349b9a],\n.customer-details .label-info .info-header[data-v-0f349b9a],\n.customer-details .order-info .info-header[data-v-0f349b9a] {\n  padding: 10px 25px;\n  border-bottom: 2px solid #f0f2f5;\n  height: 52px;\n  line-height: 32px;\n}\n.customer-details .customer-info .info-header span[data-v-0f349b9a],\n.customer-details .label-info .info-header span[data-v-0f349b9a],\n.customer-details .order-info .info-header span[data-v-0f349b9a] {\n  font-size: 16px;\n}\n.customer-details .customer-info .info-content[data-v-0f349b9a],\n.customer-details .label-info .info-content[data-v-0f349b9a],\n.customer-details .order-info .info-content[data-v-0f349b9a] {\n  padding: 10px 25px;\n}\n.customer-details .customer-info .info-content .ant-tag[data-v-0f349b9a]:hover,\n.customer-details .label-info .info-content .ant-tag[data-v-0f349b9a]:hover,\n.customer-details .order-info .info-content .ant-tag[data-v-0f349b9a]:hover {\n  background: #1890ff;\n  color: #ffffff;\n  opacity: 1;\n}\n.customer-details .customer-info .info-content .ant-form-item[data-v-0f349b9a],\n.customer-details .label-info .info-content .ant-form-item[data-v-0f349b9a],\n.customer-details .order-info .info-content .ant-form-item[data-v-0f349b9a] {\n  margin-bottom: 12px;\n}\n.tag-modal .ant-tag[data-v-0f349b9a]:hover {\n  background: #1890ff;\n  color: #ffffff;\n}\n.tag-modal .ant-tag-checkable[data-v-0f349b9a] {\n  border: 1px solid #d9d9d9;\n  background: #fafafa;\n}\n.tag-modal .ant-tag-checkable-checked[data-v-0f349b9a] {\n  background: #1890ff;\n}\n',""])},933:function(t,a,e){t.exports={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"customer-details"},[e("div",{staticStyle:{background:"rgb(240,242,245)"}},[e("a-button",{attrs:{type:"default",icon:"left"},on:{click:t.back}},[t._v("返回")])],1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"customer-info-wx"},[e("a-avatar",{staticStyle:{"border-radius":"10px"},attrs:{src:t.contactInfo.avatar_url,size:50}}),t._v(" "),e("span",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.contactInfo.nickname))]),t._v(" "),e("span",{staticStyle:{color:"rgb(136,136,136)"}},[t._v("所属店铺："+t._s(t.departmentInfo.name))])],1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"customer-info"},[e("div",{staticClass:"info-header"},[e("span",[t._v("用户信息")]),t._v(" "),e("a-button",{staticClass:"fr",staticStyle:{width:"70px"},attrs:{type:"primary"},on:{click:t.edit_save}},[t._v(t._s(t.editStatus?"保存":"编辑"))])],1),t._v(" "),e("div",{staticClass:"info-content"},[e("a-form",[e("a-row",[e("a-col",{attrs:{xl:6,md:12,xs:24}},[e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"姓名"}},[t.editStatus?e("a-input",{model:{value:t.contactInfo.real_name,callback:function(a){t.$set(t.contactInfo,"real_name",a)},expression:"contactInfo.real_name"}}):e("span",[t._v(t._s(t.contactInfo.real_name))])],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"生日"}},[t.editStatus?e("a-date-picker",{attrs:{placeholder:"生日",defaultValue:t.moment(t.contactInfo.birth,"YYYY-MM-DD")},on:{change:t.onChangeBirth}}):e("span",[t._v(t._s(t.contactInfo.birthTime))])],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"会员卡号"}},[t.editStatus?e("a-input",{model:{value:t.contactInfo.cart_number,callback:function(a){t.$set(t.contactInfo,"cart_number",a)},expression:"contactInfo.cart_number"}}):e("span",[t._v(t._s(t.contactInfo.cart_number))])],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"销售顾问"}},[t.editStatus?e("a-select",{attrs:{defaultValue:t.contactInfo.adviser_id},on:{change:t.handAdviserChange}},t._l(t.adviser_all,function(a){return e("a-select-option",{key:a.id},[t._v("\n                                        "+t._s(a.user_name)+"\n                                    ")])}),1):e("span",[t._v(t._s(t.contactInfo.adviser_name))])],1)],1),t._v(" "),e("a-col",{attrs:{xl:6,md:12,xs:24}},[e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"电话"}},[t.editStatus?e("a-input",{model:{value:t.contactInfo.tel,callback:function(a){t.$set(t.contactInfo,"tel",a)},expression:"contactInfo.tel"}}):e("span",[t._v(t._s(t.contactInfo.tel))])],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"性别"}},[t.editStatus?e("a-radio-group",{attrs:{name:"radioGroup"},model:{value:t.contactInfo.sex,callback:function(a){t.$set(t.contactInfo,"sex",a)},expression:"contactInfo.sex"}},[e("a-radio",{attrs:{value:"10"}},[t._v("男")]),t._v(" "),e("a-radio",{attrs:{value:"20"}},[t._v("女")])],1):e("span",[t._v(t._s(20==t.contactInfo.sex?"女":10==t.contactInfo.sex?"男":""))])],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"联系地址"}},[t.editStatus?e("a-input",{model:{value:t.contactInfo.detail,callback:function(a){t.$set(t.contactInfo,"detail",a)},expression:"contactInfo.detail"}}):e("span",[t._v(t._s(t.contactInfo.detail))])],1)],1),t._v(" "),e("a-col",{attrs:{xl:12,md:24,xs:24}},[e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"备注"}},[t.editStatus?e("a-textarea",{attrs:{rows:6},model:{value:t.contactInfo.desc,callback:function(a){t.$set(t.contactInfo,"desc",a)},expression:"contactInfo.desc"}}):e("p",[t._v(t._s(t.contactInfo.desc))])],1)],1)],1)],1)],1)]),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"label-info"},[e("div",{staticClass:"info-header"},[e("span",[t._v("用户信息")]),t._v(" "),e("a-button",{staticClass:"fr",staticStyle:{width:"70px"},attrs:{type:"primary"},on:{click:t.addTag}},[t._v("打标签")])],1),t._v(" "),e("div",{staticClass:"info-content"},t._l(t.contactLabel,function(a,n){return e("a-tag",{key:a.id,staticStyle:{"margin-bottom":"10px"}},[t._v("\n                    "+t._s(a.label_name)+"\n                ")])}),1)]),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"order-info"},[e("div",{staticClass:"info-header"},[e("span",[t._v("用户订单")]),t._v(" "),e("a-button",{staticClass:"fr",staticStyle:{width:"70px"},attrs:{type:"primary"},on:{click:t.addOrder}},[t._v("新建")])],1),t._v(" "),e("div",{staticClass:"info-content"},[e("a-table",{attrs:{columns:t.columns,dataSource:t.orderList,pagination:!1},scopedSlots:t._u([{key:"action",fn:function(a,n,o){return[e("div",[e("a",{staticStyle:{"padding-right":"15px"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.editOrder(n)}}},[t._v("编辑")]),t._v(" "),e("a",{staticStyle:{color:"rgba(16,16,16,1)"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.del(n.id)}}},[t._v("删除")])])]}}])}),t._v(" "),e("br"),t._v(" "),e("a-pagination",{staticStyle:{"text-align":"right"},attrs:{showQuickJumper:"",showSizeChanger:"",showTotal:function(t){return"总共"+t+"条"},pageSize:t.page_size,total:t.total,pageSizeOptions:["10","20","30","40","50"]},on:{change:t.onChange,showSizeChange:t.onShowSizeChange},model:{value:t.page,callback:function(a){t.page=a},expression:"page"}}),t._v(" "),e("br")],1)]),t._v(" "),e("a-modal",{attrs:{title:"选择标签",cancelText:"取消",okText:"确定",visible:t.selectTagFlag,confirmLoading:t.confirmLoading},on:{ok:t.handleTagOk,cancel:function(a){t.selectTagFlag=!1}}},[e("div",{staticClass:"tag-modal"},t._l(t.allLabel,function(a,n){return e("a-checkable-tag",{key:a.id,staticStyle:{"margin-bottom":"5px"},attrs:{checked:a.check},on:{change:function(e){return t.handleTagChange(a,n,e)}}},[t._v("\n                    "+t._s(a.title)+"\n                ")])}),1)]),t._v(" "),e("a-modal",{attrs:{title:t.orderTitle,cancelText:"取消",okText:"确定",visible:t.orderFlag},on:{ok:t.handleOrderOk,cancel:function(a){t.orderFlag=!1}}},[e("div",{staticClass:"order-modal"},[e("a-form",[e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"单号"}},[e("a-input",{model:{value:t.orderDetail.order_id,callback:function(a){t.$set(t.orderDetail,"order_id",a)},expression:"orderDetail.order_id"}})],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"类型"}},[e("a-radio-group",{attrs:{name:"orderGroup"},model:{value:t.orderDetail.order_type,callback:function(a){t.$set(t.orderDetail,"order_type",a)},expression:"orderDetail.order_type"}},[e("a-radio",{attrs:{value:"10"}},[t._v("购买")]),t._v(" "),e("a-radio",{attrs:{value:"20"}},[t._v("赠送")])],1)],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"类别"}},[e("a-select",{on:{change:t.handleClassChange},model:{value:t.orderDetail.goods_class_id,callback:function(a){t.$set(t.orderDetail,"goods_class_id",a)},expression:"orderDetail.goods_class_id"}},t._l(t.goodsClass,function(a,n){return e("a-select-option",{key:a.id},[t._v("\n                                "+t._s(a.title)+"\n                            ")])}),1)],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"名称"}},[e("a-select",{model:{value:t.orderDetail.goods_id,callback:function(a){t.$set(t.orderDetail,"goods_id",a)},expression:"orderDetail.goods_id"}},t._l(t.goodsAll,function(a,n){return e("a-select-option",{key:a.id},[t._v("\n                                "+t._s(a.title)+"\n                            ")])}),1)],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"数量"}},[e("a-input",{model:{value:t.orderDetail.num,callback:function(a){t.$set(t.orderDetail,"num",a)},expression:"orderDetail.num"}})],1),t._v(" "),e("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"备注"}},[e("a-textarea",{attrs:{rows:3},model:{value:t.orderDetail.desc,callback:function(a){t.$set(t.orderDetail,"desc",a)},expression:"orderDetail.desc"}})],1)],1)],1)])],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},983:function(t,a,e){var n=e(849);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);e(4)("23a2d141",n,!1)}});